<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Custom event for detecting fetch errors in Backbone.js &middot; Monica</title>
        <meta name="description" content="My tech blog, covering javascript, python, and fun unix tricks I learn while developing software.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.21" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="http://monicalent.com/blog/css/normalize.css">
        
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@monicalent" />
        <meta name="twitter:title" content="Custom event for detecting fetch errors in Backbone.js by Monica" />
        <meta name="twitter:description" content="My tech blog, covering javascript, python, and fun unix tricks I learn while developing software." />
        <meta name="twitter:image" content="http://monicalent.com/assets/images/image01.jpg" />
        <link rel="stylesheet" href="http://monicalent.com/blog/css/prism.css">
        <link rel="stylesheet" href="http://monicalent.com/blog/css/style.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    </head>
    <body>
        
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40399378-2', 'auto');
ga('send', 'pageview');
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Custom event for detecting fetch errors in Backbone.js" href="http://monicalent.com/blog/">Custom event for detecting fetch errors in Backbone.js</a>
                            </h1>
                        
                        <a class="button-square" href="http://monicalent.com/blog/index.xml"><i class="fa fa-rss"></i></a>
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/monicalent">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/mlent">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Google+" title="Google+" href="https://google.com/&#43;MonicaLent">
                                <i class="fa fa-google-plus"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="/blog/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="Website" href="http://monicalent.com/">Website</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="http://monicalent.com/#about">About</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Custom event for detecting fetch errors in Backbone.js</h1>
    
    <p class="post-date">
        <span>Published <time datetime="2013-07-29" itemprop="datePublished">Mon, Jul 29, 2013</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="http://schema.org/Person">
            <span itemprop="name">
                <a href="http://monicalent.com" itemprop="url" rel="author">Monica</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    

<p>One of Backbone&rsquo;s major strengths as a javascript MVC framework is the way it helps you do event handling. By extension, it&rsquo;s also great for handling errors that result from failed AJAX calls. As you can see in the <a href="http://backbonejs.org/#Events-catalog">Backbone.js documentation</a>, the <code>error</code> event is triggered when a model&rsquo;s attempt to save fails server-side. However, there is no Backbone event that detects when the <code>fetch</code> event fails. Since a fetch from the server is the first thing that happens when a page is loaded, you would need to know if it fails because that could indicate that the API is down or some other server error.</p>

<!-- more -->

<p>One way to handle this is that every time you call fetch, you specify an error function. However, this precludes us from being able to organize our failed fetches nicely within Views themselves, as we would with other events that occur on collections such as <code>add</code> or <code>reset</code>. For example:</p>

<pre><code>MyApp.Views.Foo = Backbone.View.extend({
  'tagName': 'div',
  template: _.template(MyApp.Templates.foo_template),
  initialize: function() {
    MyApp.models.bind('fail', this.show_failure, this);
  },
  render: function() {
    this.$el.html(this.template(this.model.toJSON()));
    return this;
  },
  show_failure: function() {
    // Update DOM to denote failure to fetch models
  }
});
</code></pre>

<p>You can trigger a &lsquo;fail&rsquo; event, or any other kind of event, by modifying your base collection. In this case, I am modifying the <code>fetch</code> event handler to trigger a <code>fail</code> event in the case that it fails.</p>

<pre><code>MyApp.Collections.Base = Backbone.Collection.extend({
  fetch: function(options) {
    var self = this;
    var opts =  { 
      success: function() {
        if (options &amp;&amp; options.success)
          options.success(self);
      },
      error: function() {
        // Allow views to respond to failed fetch calls
        self.trigger('fail');
        if (options &amp;&amp; options.error)
          options.error(self);
      } 
    };

    // Combine options and custom handlers, apply to fetch prototype, call.
    (_.bind(Backbone.Collection.prototype.fetch, this, _.extend({}, options, opts)))();
  }
});
</code></pre>

<p>Looking at <a href="http://backbonejs.org/docs/backbone.html#section-55">Backbone.js annotated source code</a> is really helpful to understand how to override certain functions.</p>

<hr />

<h2 id="questions-comments-corrections">Questions, Comments, Corrections?</h2>

<p>Get in touch via Twitter at <a href="http://www.twitter.com/monicalent">@monicalent</a>.</p>

</div>

        <footer class="post-footer clearfix">
    

    <div class="share">
        <a class="icon-twitter" href="http://twitter.com/share?text=Custom%20event%20for%20detecting%20fetch%20errors%20in%20Backbone.js&url=http%3a%2f%2fmonicalent.com%2fblog%2f2013%2f07%2f29%2fusing-a-custom-event-to-detect-fetch-errors-in-backbone-js%2f"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>

        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmonicalent.com%2fblog%2f2013%2f07%2f29%2fusing-a-custom-event-to-detect-fetch-errors-in-backbone-js%2f"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook"></i>
            <span class="hidden">Facebook</span>
        </a>

        <a class="icon-google-plus" href="https://plus.google.com/share?url=http%3a%2f%2fmonicalent.com%2fblog%2f2013%2f07%2f29%2fusing-a-custom-event-to-detect-fetch-errors-in-backbone-js%2f"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
           <i class="fa fa-google-plus"></i>
            <span class="hidden">Google+</span>
        </a>
    </div>
</footer>


        
    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="Custom event for detecting fetch errors in Backbone.js" href="http://monicalent.com/blog/">Custom event for detecting fetch errors in Backbone.js</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2017 Monica Lent</span>
                </p>
            </div>
        </footer>

        <script src="http://monicalent.com/blog/js/jquery-1.11.3.min.js"></script>
        
        <script src="http://monicalent.com/blog/js/jquery.fitvids.js"></script>
        <script src="http://monicalent.com/blog/js/scripts.js"></script>
        <script src="http://monicalent.com/blog/js/prism.js"></script>
    </body>
</html>

